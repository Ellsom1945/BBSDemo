(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15bc7dd2"],{"178b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"communityContainer"},[i("div",{staticClass:"community"},[i("div",{staticClass:"left"},[i("div",{staticClass:"write"},[i("el-button",{staticClass:"writeButton",attrs:{type:"primary"},on:{click:t.writeArticle}},[t._v("\n          写文章")])],1),i("div",{staticClass:"sort"},[i("div",{staticClass:"sortItem",class:0==t.$route.query.typeId?"currentItem":"",on:{click:function(e){return t.changeType(0)}}},[i("i",{staticClass:"iconfont icon-xiaoxi"}),t._v("  所有文章\n        ")]),t._l(t.allType,(function(e,a){return i("div",{key:a,staticClass:"sortItem",class:t.$route.query.typeId==e.typeId?"currentItem":"",on:{click:function(a){return t.changeType(e.typeId)}}},[i("i",{staticClass:"iconfont icon-xiaoxi"}),t._v("  "+t._s(e.typeName)+"\n        ")])}))],2)]),i("div",{staticClass:"right"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isDataLoad,expression:"isDataLoad"}],staticClass:"article"},t._l(t.articleList,(function(e,r){return i("div",{key:r,staticClass:"articleItem",on:{click:function(a){return t.$router.push({name:"article",params:{id:e.articleId}})}}},[i("div",{staticClass:"userAvatar"},[i("img",{attrs:{src:e.avatar&&""!=e.avatar?e.avatar:a("bdf7"),alt:"",lazy:"",fit:"cover"}})]),i("div",{staticClass:"ItemCenter"},[i("div",{staticClass:"title"},[t._v(t._s(e.articleTitle))]),i("div",{staticClass:"publishDate"},[t._v("\n              "+t._s(t._f("handleArticleDateShow")(e.createTime))+"\n            ")]),i("div",{staticClass:"content mdContent",domProps:{innerHTML:t._s(t.handleMarkDown(e.articleContent))}}),i("div",{staticClass:"articleImg"},[""!=e.articleImage?i("img",{staticClass:"articleImgItem",attrs:{src:e.articleImage,fit:"contain",lazy:""}}):t._e()])]),i("div",{staticClass:"ItemRight"},[i("div",{staticClass:"replyCount"},[i("i",{staticClass:"iconfont icon-kuaisuhuifu"}),t._v("\n              "+t._s(e.commentNum)+"\n            ")])])])})),0),0==t.articleList.length&&0==t.isDataLoad?i("div",{staticClass:"nullTips"},[t._v("\n        Article Not Found !\n      ")]):t._e(),t.isDataLoad||0===t.articleList.length?t._e():i("div",{staticClass:"bottom"},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalCount,"current-page":1*this.$route.query.page},on:{"current-change":t.changePage}})],1)])]),i("write-card",{attrs:{isCardShow:t.isWriteCardShow},on:{reFreshArticleList:t.reFreshArticleList,closeCard:function(e){t.isWriteCardShow=!1}}}),i("go-top")],1)},r=[],n=a("1da1"),s=(a("96cf"),a("d4cd")),c=a.n(s),o=a("d930"),l=a("7cff"),u=a("a350"),d={name:"community",components:{GoTop:l["a"],WriteCard:u["a"]},data:function(){return{imgArr:[],articleList:[],allType:[],isWriteCardShow:!1,totalCount:0,isDataLoad:!0}},methods:{getAllArticle:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isDataLoad=!0,e.next=3,t.$request("/dqarticle/superlist",{pageNum:t.$route.query.page,pageSize:10});case 3:a=e.sent,200==a.data.code&&(t.totalCount=a.data.data.total,t.articleList=a.data.data.list,t.isDataLoad=!1,window.scrollTo({top:0,behavior:"smooth"}));case 5:case"end":return e.stop()}}),e)})))()},getAllType:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request("/dqtype/list",{pageSize:30});case 2:a=e.sent,t.allType=a.data.data.list;case 4:case"end":return e.stop()}}),e)})))()},searchArticle:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isDataLoad=!0,e.next=3,t.$request("/dqarticle/superlist?articleTitle=".concat(t.$route.query.articleTitle),{pageNum:1,pageSize:10});case 3:a=e.sent,console.log(a),200==a.data.code?(t.totalCount=a.data.data.total,t.articleList=a.data.data.list):404==a.data.code&&(t.totalCount=0,t.articleList=[]),t.isDataLoad=!1;case 7:case"end":return e.stop()}}),e)})))()},getArticleById:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isDataLoad=!0,a.next=3,e.$request("/dqarticle/superlist?typeId=".concat(t),{pageNum:e.$route.query.page,pageSize:10});case 3:i=a.sent,console.log(i),200==i.data.code?(e.articleList=i.data.data.list,e.totalCount=i.data.data.total,e.isDataLoad=!1,window.scrollTo({top:0,behavior:"smooth"})):404==i.data.code&&(e.articleList=[],e.totalCount=0,e.isDataLoad=!1);case 6:case"end":return a.stop()}}),a)})))()},getArticleCommentNum:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(void 0!=t){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,e.$request("/number/dqarticle/".concat(t));case 4:if(i=a.sent,200!=i.data.code){a.next=8;break}return r=i.data.data,a.abrupt("return",r);case 8:case"end":return a.stop()}}),a)})))()},changeType:function(t){this.$route.query.typeId!=t&&(this.$router.push({name:"community",query:{typeId:t,page:1}}),0==t?this.getAllArticle():this.getArticleById(t))},reFreshArticleList:function(){0==this.$route.query.typeId?this.getAllArticle():this.getArticleById(this.$route.query.typeId)},changePage:function(t){this.$router.push({name:"community",query:{typeId:this.$route.query.typeId,page:t}}),0==this.$route.query.typeId?this.getAllArticle():this.getArticleById(this.$route.query.typeId)},writeArticle:function(){window.localStorage.getItem("tokenValue")?this.isWriteCardShow=!0:this.$message.info("登录后才能发布文章哦!")},handleMarkDown:function(t){var e=new c.a,a=e.render(t);return a}},computed:{},filters:{handleArticleDateShow:o["a"]},watch:{"$route.query":function(t){t.articleTitle&&!t.typeId?(console.log(t.articleTitle),this.searchArticle()):0==t.typeId&&1==t.page&&this.getAllArticle()}},created:function(){this.getAllType(),0==this.$route.query.typeId?this.getAllArticle():this.$route.query.typeId?this.getArticleById(this.$route.query.typeId):this.searchArticle()}},p=d,m=(a("4d47"),a("2877")),g=Object(m["a"])(p,i,r,!1,null,"6ec71029",null);e["default"]=g.exports},"2a56":function(t,e,a){"use strict";a("4cf5")},"4cf5":function(t,e,a){},"4d47":function(t,e,a){"use strict";a("d6d6")},a350:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"writeCard",class:[t.isCardShow?"showCard":"hideCard",t.isEnlarge?"enlarge":"",t.isMinimize?"minimize":""]},[i("div",{staticClass:"cardContorl"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMinimize,expression:"!isMinimize"}],staticClass:"contorlItem"},[i("i",{staticClass:"iconfont icon-zuixiaohua",on:{click:function(e){t.isMinimize=!0}}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMinimize,expression:"!isMinimize"}],staticClass:"contorlItem"},[t.isEnlarge?i("i",{staticClass:"iconfont icon-suoxiao",on:{click:function(e){t.isEnlarge=!1}}}):i("i",{staticClass:"iconfont icon-fangda",on:{click:function(e){t.isEnlarge=!0}}})]),i("div",{staticClass:"contorlItem"},[i("i",{staticClass:"iconfont icon-guanbi1",on:{click:t.closeCard}})])]),i("div",{staticClass:"cardHead",class:t.isMinimize?"clickAble":"",on:{click:t.clickHead}}),i("div",{staticClass:"cardBody"},[i("div",{staticClass:"left"},[i("el-image",{attrs:{src:t.$store.state.userInfo.avatar?t.$store.state.userInfo.avatar:a("bdf7"),fit:"cover"}})],1),i("div",{staticClass:"right"},[i("div",[i("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.newArticleData.typeId,callback:function(e){t.$set(t.newArticleData,"typeId",e)},expression:"newArticleData.typeId"}},t._l(t.articleType,(function(t){return i("el-option",{key:t.typeId,attrs:{label:t.typeName,value:t.typeId}})})),1),i("input",{directives:[{name:"model",rawName:"v-model",value:t.newArticleData.articleTitle,expression:"newArticleData.articleTitle"}],staticClass:"title",attrs:{placeholder:"标题"},domProps:{value:t.newArticleData.articleTitle},on:{input:function(e){e.target.composing||t.$set(t.newArticleData,"articleTitle",e.target.value)}}})],1),i("div",{staticClass:"contentContainer"},[i("div",{staticClass:"contentInput"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newArticleData.articleContent,expression:"newArticleData.articleContent"}],staticClass:"content",attrs:{placeholder:"说点什么吧"},domProps:{value:t.newArticleData.articleContent},on:{input:function(e){e.target.composing||t.$set(t.newArticleData,"articleContent",e.target.value)}}})]),i("div",{staticClass:"mdLive",class:t.isMdLiveShow?"mdLiveShow":"mdLiveHide",domProps:{innerHTML:t._s(t.handleMarkDown)}})])])]),i("div",{staticClass:"cardBottomContorl"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.addArticle}},[t._v("发布")]),i("div",{staticClass:"bottomBtnContainer"},[i("el-upload",{attrs:{multiple:"",action:"/xiaopopan/eduoss/fileoss/upload/1413125531471233026?catalogue=/root/drawingBed","show-file-list":!1,"on-success":t.imgUploadSuccess,"on-error":t.imgUploadError,"before-upload":t.beforeImgUpload}},[i("div",{staticClass:"bottomBtn"},[i("i",{staticClass:"iconfont icon-tupian"})])]),i("el-popover",{attrs:{trigger:"hover",width:"200"}},[i("el-upload",{attrs:{slot:"reference",action:"/xiaopopan/eduoss/fileoss/upload/1413125531471233026?catalogue=/root/drawingBed","show-file-list":!1,"on-success":t.uploadSuccess,"on-error":t.uploadError,"before-upload":t.beforeImgUpload},slot:"reference"},[i("div",{staticClass:"bottomBtn"},[t._v("上传封面")])]),i("img",{staticClass:"popoverImg",attrs:{src:t.newArticleData.articleImage,alt:""}})],1),i("div",{staticClass:"bottomBtn",on:{click:function(e){t.isMdLiveShow=!t.isMdLiveShow}}},[t._v("\n        "+t._s(t.isMdLiveShow?"关闭":"打开")+"md效果预览\n      ")])],1)],1)])},r=[],n=a("1da1"),s=(a("99af"),a("b0c0"),a("ac1f"),a("1276"),a("96cf"),a("d4cd")),c=a.n(s),o={name:"writeCard",props:{isCardShow:{type:Boolean,default:function(){return!1}},userInfo:{type:Object,default:function(){return{}}},originArticle:{type:Object,default:function(){return{}}}},data:function(){return{isEnlarge:!1,isMinimize:!1,newArticleData:{typeId:null,articleTitle:"",articleContent:"",articleImage:"https://chen110.oss-cn-guangzhou.aliyuncs.com/2021/08/03/wallhaven-4ooz99.jpg"},articleType:[],isMdLiveShow:!1}},methods:{addArticle:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.newArticleData.typeId){e.next=5;break}return t.$message.warning("请选择文章分类哦!"),e.abrupt("return");case 5:if(""!=t.newArticleData.articleTitle){e.next=10;break}return t.$message.warning("请填写文章标题哦!"),e.abrupt("return");case 10:if(""!=t.newArticleData.articleContent){e.next=15;break}return t.$message.warning("请填写文章内容哦!"),e.abrupt("return");case 15:if(""!=t.newArticleData.articleImage){e.next=18;break}return t.$message.warning("请上传背景图片哦!"),e.abrupt("return");case 18:if(!t.originArticle.articleId){e.next=27;break}if(t.newArticleData.typeId!=t.originArticle.typeId||t.newArticleData.articleTitle!=t.originArticle.articleTitle||t.newArticleData.articleContent!=t.originArticle.articleContent||t.newArticleData.articleImage!=t.originArticle.articleImage){e.next=22;break}return t.$message.warning("文章没有改动哦!"),e.abrupt("return");case 22:return e.next=24,t.$request("/dqarticle/update",t.newArticleData,"post");case 24:a=e.sent,e.next=30;break;case 27:return e.next=29,t.$request("/dqarticle/add",t.newArticleData,"post");case 29:a=e.sent;case 30:if(console.log(a),200!=a.data.code){e.next=36;break}t.$emit("reFreshArticleList"),t.closeCard(),e.next=41;break;case 36:if("登陆无效"!=a.data.data){e.next=41;break}return window.localStorage.removeItem("tokenValue"),t.$store.commit("updateUserInfo",{}),t.$message.info("登录失效,请重新登录后重试!"),e.abrupt("return");case 41:case"end":return e.stop()}}),e)})))()},getArticalType:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request("/dqtype/list",{pageSize:30});case 2:a=e.sent,console.log(a),t.articleType=a.data.data.list;case 5:case"end":return e.stop()}}),e)})))()},clickHead:function(){this.isMinimize&&(this.isMinimize=!1)},closeCard:function(){this.isEnlarge=!1,this.isMinimize=!1,this.isMdLiveShow=!1,this.originArticle.articleId?(this.newArticleData.typeId=this.originArticle.typeId,this.newArticleData.articleTitle=this.originArticle.articleTitle,this.newArticleData.articleContent=this.originArticle.articleContent,this.newArticleData.articleImage=this.originArticle.articleImage,this.newArticleData.articleId=this.originArticle.articleId):this.newArticleData={typeId:null,articletitle:"",articlecontent:"",articleImage:"https://chen110.oss-cn-guangzhou.aliyuncs.com/2021/08/03/wallhaven-4ooz99.jpg"},this.$emit("closeCard")},uploadSuccess:function(t){console.log(t),this.newArticleData.articleImage=t.data.file.url,this.$message.success("封面上传成功!")},uploadError:function(t){console.log(t),this.$message.error("封面上传失败, 请稍后重试!")},imgUploadSuccess:function(t){var e="![".concat(t.data.file.name,"](").concat(t.data.file.url,' "').concat(t.data.file.name,'")   ');this.newArticleData.articleContent+=e},imgUploadError:function(t){this.$message.error("图片上传失败, 请稍后重试!")},beforeImgUpload:function(t){var e=t.size/1024/1024<=1,a="image/jpeg"===t.type||"image/png"===t.type||"image/bmp"===t.type,i=t.name.split(" ").length>1;return a||this.$message.warning("上传的图片只能是 JPG/PNG/BMP 格式!"),e||this.$message.warning("上传的图片大小不能超过 1MB 哦!"),i&&this.$message.warning("上传的图片名不能包含空格哦!"),a&&e&&!i}},created:function(){this.getArticalType()},watch:{isCardShow:function(t){t&&this.originArticle.articleId&&(this.newArticleData.typeId=this.originArticle.typeId,this.newArticleData.articleTitle=this.originArticle.articleTitle,this.newArticleData.articleContent=this.originArticle.articleContent,this.newArticleData.articleImage=this.originArticle.articleImage,this.newArticleData.articleId=this.originArticle.articleId)}},computed:{handleMarkDown:function(){if(this.isMdLiveShow){var t=new c.a,e=t.render(this.newArticleData.articleContent);return'<div class="mdTips">md效果预览:</div>'+e}}}},l=o,u=(a("2a56"),a("2877")),d=Object(u["a"])(l,i,r,!1,null,"540f6fb3",null);e["a"]=d.exports},bdf7:function(t,e,a){t.exports=a.p+"static/img/defaultAvatar.16a68dc4.jpg"},d6d6:function(t,e,a){},d930:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("fb6a"),a("ac1f"),a("1276");function i(t){if(null==t)return"Unknown time";t=t.slice(0,10);var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),n=t.split("-");return n[0]=parseInt(n[0]),n[1]=parseInt(n[1]),n[2]=parseInt(n[2]),n[0]==a&&n[1]==i&&n[2]==r?"今天":n[0]==a?n[1]+"月"+n[2]+"日":n[0]+"年"+n[1]+"月"+n[2]+"日"}}}]);
//# sourceMappingURL=chunk-15bc7dd2.96cf7caf.js.map